---
title: UML：组合和聚合、关联和依赖
layout: post
subtitle: UML Design
date:       2020-03-10
author:     "Zhao"
header-img: "img/design.png"
tags: 
    - Design
---

本文转自https://www.chenb.top/2016/08/02/java-1/ ，作者Chen Bin，遵循CC 4.0。

> ~~类A的属性是另一个类B，那么这两个类是关联的，但不一定是聚合，如果在A类中创建了B类的实例（使用new！），那么B类和A类就是聚合关系，但不一定是组合关系，因为不一定在A类创建的同时去创建B类的实例，反之则B类和A类就是组合关系了！~~
> `关于判断两者关系，具体问题具体分析，最主要还是要看生命周期！`
> 
> 聚合：表示两个对象之间是整体和部分的弱关系，部分的生命周期可以超越整体。如电脑和鼠标。
> 
> 组合：表示两个对象之间是整体和部分的强关系，部分的生命周期不能超越整体，或者说不能脱离整体而存在。组合关系的“部分”，是不能在整体之间进行共享的。
> 
> 不过，如果你要说，眼睛可以移植，是不是说可以脱离人而存在，它们就不是组合关系了？其实，UML中对象的关系都是在相应的软件环境或实际场景下定义的，这里区别聚合和组合的关系，关键还是在于它们之中整体和部分的关系强、弱，以及它们之间的依附关系。如果刚才说眼睛可以移植给别人，那你也可以把它认为是聚合，这都要结合实际场景来说明。
> 
> 另外两个比较重要的关系是关联和依赖：
> 关联：简单的可以认为，如果一个类作为了另外一个类的属性，那一定是关联关系。但你要知道，`聚合是一种特殊的关联，而组合又是一种特殊的聚合。`一般的关联我们认为是平级的、无整体部分关系的，如朋友关系。
> 
> 依赖：对象之间的临时关系，临时性体现在不超越方法的周期。简单的说，在方法使用到的，如参数类，就一定是依赖关系。
> 
> **is a 关系**，那么它是一个集成关系；比如：我 is a 人；再比如菱形、圆形和方形都是形状的一种，那么他们都应该从形状类继承而不是聚合。
> 
> **has a关系**，那么它是一个聚合关系；比如：我 has a 头；再比如电脑是由显示器、CPU、硬盘等组成的，那么你应该把显示器、CPU、硬盘这些类聚合成电脑类，而不是从电脑类继承。
> 
> 聚合和组合都属于关联，很难区分，但是只要记住一点，区分它们就容易多了：
> 
> `处于聚合关系的两个类生命周期不同步，则是聚合关系；处于组合关系的两个类的生命周期同步；`
> 
> `eg：聚合关系,当A创建的时候，B不一定创建；当A消亡时，B不一定消亡。class A{   private  B;}class B{....}`
> 
> `组合关系，当创建一个A对象时，也会创建一个B对象；当A对象消亡时，作为A的属性的B对象也会消亡。class A{private B b=new B();....}class B{....}`

在UML类图中，常见的有以下几种关系: 泛化（Generalization）,  实现（Realization）, 关联（Association), 聚合（Aggregation）, 组合(Composition), 依赖(Dependency)

1. 泛化（Generalization）
【泛化关系】：是一种继承关系, 表示一般与特殊的关系, 它指定了子类如何特化父类的所有特征和行为. 例如：老虎是动物的一种, 即有老虎的特性也有动物的共性.
【箭头指向】：带三角箭头的实线，箭头指向父类
![javase_14.jpg](https://i.loli.net/2020/03/10/ouVSpiAfnb5aXE2.jpg)

1. 实现（Realization）
【实现关系】：是一种类与接口的关系, 表示类是接口所有特征和行为的实现.
【箭头指向】：带三角箭头的虚线，箭头指向接口
![javase_15.jpg](https://i.loli.net/2020/03/10/GMoN8vyEipzIFm1.jpg)

1. 关联（Association)
【关联关系】：是一种拥有的关系, 它使一个类知道另一个类的属性和方法；如：老师与学生，丈夫与妻子
关联可以是双向的，也可以是单向的。双向的关联可以有两个箭头或者没有箭头，单向的关联有一个箭头。
【代码体现】：成员变量
【箭头及指向】：带普通箭头的实心线，指向被拥有者
![javase_16.jpg](https://i.loli.net/2020/03/10/ib8zCrvfZud9AhS.jpg)
上图中，老师与学生是双向关联，老师有多名学生，学生也可能有多名老师。但学生与某课程间的关系为单向关联，一名学生可能要上多门课程，课程是个抽象的东西他不拥有学生。
![javase_17.jpg](https://i.loli.net/2020/03/10/eKZpSTaQXq39kV1.jpg)
上图为自身关联：

1. 聚合（Aggregation）
【聚合关系】：是整体与部分的关系, 且部分可以离开整体而单独存在. 如车和轮胎是整体和部分的关系, 轮胎离开车仍然可以存在.
聚合关系是关联关系的一种，是强的关联关系；关联和聚合在语法上无法区分，必须考察具体的逻辑关系。
【代码体现】：成员变量
【箭头及指向】：带空心菱形的实心线，菱形指向整体
![javase_18.jpg](https://i.loli.net/2020/03/10/RuOcC1aYFjNAzwd.jpg)

1. 组合(Composition)
【组合关系】：是整体与部分的关系, 但部分不能离开整体而单独存在. 如公司和部门是整体和部分的关系, 没有公司就不存在部门.
   组合关系是关联关系的一种，是比聚合关系还要强的关系，它要求普通的聚合关系中代表整体的对象负责代表部分的对象的生命周期
【代码体现】：成员变量
【箭头及指向】：带实心菱形的实线，菱形指向整体
![javase_19.jpg](https://i.loli.net/2020/03/10/vBjEIAarTuf5o9c.jpg)

1. 依赖(Dependency)
【依赖关系】：是一种使用的关系,  即一个类的实现需要另一个类的协助, 所以要尽量不使用双向的互相依赖.
【代码表现】：局部变量、方法的参数或者对静态方法的调用
【箭头及指向】：带箭头的虚线，指向被使用者
![javase_20.jpg](https://i.loli.net/2020/03/10/l96YQXuHMkZvG4T.jpg)

各种关系的强弱顺序：
`泛化 = 实现 > 组合 > 聚合 > 关联 > 依赖`
下面这张UML图，比较形象地展示了各种类图关系：
![javase_21.jpg](https://i.loli.net/2020/03/10/fRSuJEKI4awbZ3F.jpg)